<launch>
  <!-- Object Follower Launch File -->
  
  <!-- Parameters -->
  <param name="use_sim_time" value="false"/>
  
  <!-- Object Detection Node -->
  <node name="object_detector" pkg="object_follower" type="object_detector.py" output="screen">
    <param name="detection_method" value="color"/>
    <!-- For testing with webcam or standard camera -->
    <remap from="/camera/image_raw" to="/usb_cam/image_raw"/>
  </node>
  
  <!-- Motor Controller Node -->
  <node name="motor_controller" pkg="object_follower" type="motor_controller.py" output="screen">
    <param name="max_speed" value="0.3"/>
    <param name="target_distance" value="1.0"/>
    <param name="distance_tolerance" value="0.2"/>
    <param name="kp_lateral" value="2.0"/>
    <param name="ki_lateral" value="0.1"/>
    <param name="kd_lateral" value="0.5"/>
    <param name="kp_distance" value="1.0"/>
    <param name="ki_distance" value="0.05"/>
    <param name="kd_distance" value="0.2"/>
  </node>
  
  <!-- Obstacle Detector Node -->
  <node name="obstacle_detector" pkg="object_follower" type="obstacle_detector.py" output="screen">
    <param name="detection_method" value="edge"/>
    <param name="min_obstacle_area" value="1000"/>
    <param name="safe_distance_pixels" value="100"/>
    <!-- For testing with webcam or standard camera -->
    <remap from="/camera/image_raw" to="/usb_cam/image_raw"/>
  </node>
  
  <!-- Optional: USB Camera for testing (comment out when using DuckieBot) -->
  <!-- 
  <node name="usb_cam" pkg="usb_cam" type="usb_cam_node" output="screen">
    <param name="video_device" value="/dev/video0"/>
    <param name="image_width" value="640"/>
    <param name="image_height" value="480"/>
    <param name="pixel_format" value="yuyv"/>
    <param name="camera_frame_id" value="usb_cam"/>
    <param name="io_method" value="mmap"/>
  </node>
  -->
  
</launch>