<launch>
  <!-- DuckieBot Deployment Launch File - Optimized for Official duckietown_msgs -->
  
  <!-- Parameters -->
  <param name="use_sim_time" value="false"/>
  
  <!-- Enhanced Object Detection Node -->
  <node name="enhanced_object_detector" pkg="object_follower" type="enhanced_object_detector.py" output="screen">
    <param name="detection_method" value="color"/>
    <param name="target_color" value="red"/>
    <!-- Handles both compressed (DuckieBot) and raw (local) images automatically -->
  </node>
  
  <!-- Enhanced Motor Controller Node - DuckieBot Optimized -->
  <node name="enhanced_motor_controller" pkg="object_follower" type="enhanced_motor_controller.py" output="screen">
    <param name="max_speed" value="0.25"/>
    <param name="target_distance" value="0.7"/>
    <param name="distance_tolerance" value="0.15"/>
    <param name="wheel_distance" value="0.1"/>
    <!-- Conservative PID for DuckieBot hardware -->
    <param name="kp_lateral" value="1.2"/>
    <param name="ki_lateral" value="0.05"/>
    <param name="kd_lateral" value="0.3"/>
    <param name="kp_distance" value="0.6"/>
    <param name="ki_distance" value="0.02"/>
    <param name="kd_distance" value="0.1"/>
  </node>
  
  <!-- Obstacle Detector Node -->
  <node name="obstacle_detector" pkg="object_follower" type="obstacle_detector.py" output="screen">
    <param name="detection_method" value="edge"/>
    <param name="min_obstacle_area" value="600"/>
    <param name="safe_distance_pixels" value="60"/>
  </node>
  
  <!-- Performance Monitor -->
  <node name="performance_monitor" pkg="object_follower" type="performance_monitor.py" output="screen">
    <param name="target_distance" value="0.7"/>
  </node>
  
  <!-- System Monitor -->
  <node name="system_monitor" pkg="object_follower" type="system_monitor.py" output="screen"/>
  
</launch>